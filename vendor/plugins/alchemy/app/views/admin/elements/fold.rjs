if @error
  page.replace("element_#{@element.id}_folder_spinner", "<span class='error_icon' title='#{@error}'>!</span>")
else
  page.replace(
    "element_#{@element.id}",
    :partial => "element",
    :object => @element,
    :locals => {:draggable => true}
  )
  page << "jQuery('#element_area').sortable('refresh')"
  page << "Alchemy.ElementEditorSelector.reinit('#element_#{@element.id}')"
  if @element.folded
    @element.rtf_contents.each do |content|
      page << "rtf_#{content.id} = tinymce.get('#{content.form_field_id}'); if (rtf_#{content.id}) {rtf_#{content.id}.remove();}; delete rtf_#{content.id}"
    end
  else
    page << "jQuery('#element_#{@element.id}').trigger('Alchemy.SelectElementEditor')"
    page << "Alchemy.SelectBox('#element_#{@element.id} select')"
    page << "Alchemy.ButtonObserver('#element_#{@element.id} button.button')"
    @element.rtf_contents.each do |content|
      page << "TinymceHammer.addEditor('#{content.form_field_id}')"
    end
    page << "Alchemy.ElementDirtyObserver('#element_#{@element.id}')"
  end
end
